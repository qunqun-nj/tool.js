/*!
 * 💡 tool.js - 💡 前端常用的工具类方法汇总。
 * git+https://github.com/hai2007/tool.js.git
 *
 * author 你好2007 < https://hai2007.gitee.io/sweethome >
 *
 * version 1.0.0
 *
 * Copyright (c) 2020-present hai2007 走一步，再走一步。
 * Released under the MIT license
 *
 * Date:Sat Nov 27 2021 13:25:15 GMT+0800 (GMT+08:00)
 */
(function(){"use strict";var f=[];var o=13;var i=400;var l=null;function e(t,e,n){if(arguments.length<2)e=i;var u={timer:function(e,t,n){if(!e){throw new Error("Tick is required!")}var r=(new Date).valueOf()+"_"+(Math.random()*1e3).toFixed(0);f.push({id:r,createTime:new Date,tick:e,duration:t,callback:n});u.start();return r},start:function(){if(!l){l=setInterval(u.tick,o)}},tick:function(){var e,t,n,r,o,i,l,a=f;f=[];f.length=0;for(t=0;t<a.length;t++){o=a[t];e=o.createTime;n=o.tick;i=o.duration;r=o.callback;l=(+new Date-e)/i;l=l>1?1:l;n(l);if(l<1&&o.id){f.push(o)}else if(r){r(l)}}if(f.length<=0){u.stop()}},stop:function(){if(l){clearInterval(l);l=null}}};var r=u.timer(function(e){t(e)},e,n);return function(){var e;for(e in f){if(f[e].id==r){f[e].id=undefined;return}}}}function a(e,t,n,r){r=r||0;var o=Math.sqrt(t*t+n*n+r*r);return[1,0,0,0,0,1,0,0,0,0,1,0,t*e/o,n*e/o,r*e/o,1]}function c(e){var t=Math.sin(e),n=Math.cos(e);return[n,t,0,0,-t,n,0,0,0,0,1,0,0,0,0,1]}function s(e,t,n,r,o,i){r=r||0;o=o||0;i=i||0;return[e,0,0,0,0,t,0,0,0,0,n,0,r-r*e,o-o*t,i-i*n,1]}function h(e,t,n,r,o,i){if(typeof e==="number"&&typeof t==="number"){if(typeof n!=="number"){n=0;r=e;o=t;i=1}else if(typeof r!=="number"||typeof o!=="number"||typeof i!=="number"){r=e;o=t;i=n;e=0;t=0;n=0}if(e==r&&t==o&&n==i)throw new Error("It's not a legitimate ray!");var l=Math.sqrt((r-e)*(r-e)+(o-t)*(o-t)),a=l!=0?(o-t)/l:1,u=l!=0?(r-e)/l:0,f=(r-e)*u+(o-t)*a,c=i-n,s=Math.sqrt(f*f+c*c),h=s!=0?c/s:1,v=s!=0?f/s:0;return[[a,h*u,u*v,0,-u,a*h,a*v,0,0,-v,h,0,t*u-e*a,n*v-e*u*h-t*a*h,-e*u*v-t*a*v-n*h,1],[a,-u,0,0,h*u,h*a,-v,0,u*v,a*v,h,0,e,t,n,1]]}else{throw new Error("a1 and b1 is required!")}}var v=function(e,t){var n=[];for(var r=0;r<4;r++)for(var o=0;o<t.length/4;o++)n[o*4+r]=e[r]*t[o*4]+e[r+4]*t[o*4+1]+e[r+8]*t[o*4+2]+e[r+12]*t[o*4+3];return n};function t(e){var u=e||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var f={move:function(e,t,n,r){u=v(a(e,t,n,r),u);return f},rotate:function(e,t,n,r,o,i,l){var a=h(t,n,r,o,i,l);u=v(v(v(a[1],c(e)),a[0]),u);return f},scale:function(e,t,n,r,o,i){u=v(s(e,t,n,r,o,i),u);return f},multiply:function(e,t){u=t?v(u,e):v(e,u);return f},use:function(e,t,n,r){n=n||0;r=r||1;var o=v(u,[e,t,n,r]);o[0]=+o[0].toFixed(7);o[1]=+o[1].toFixed(7);o[2]=+o[2].toFixed(7);o[3]=+o[3].toFixed(7);return o},value:function(){return u}};return f}function n(e,t){for(var n in t)try{e[n]=t[n]}catch(e){throw new Error("Illegal property value！")}return e}function r(u){u=n({u:.5},u);var f,c,s;var h=function(e){if(f){var t=(e-c)/(s-c),n=t*t,r=t*n;var o=r*f[0]+n*f[1]+t*f[2]+f[3];return o*(s-c)}else throw new Error("You shoud first set the position!")};h.setP=function(e,t,n,r,o,i){if(e<n){c=e;s=n;var l=u.u*o,a=u.u*i;t/=n-e;r/=n-e;f=[2*t-2*r+l+a,3*r-3*t-2*l-a,l,t]}else throw new Error("The point x-position should be increamented!");return h};return h}function u(e){var t=typeof e;return e!=null&&(t==="object"||t==="function")}var p=Object.prototype.toString;function g(e){if(e==null){return e===undefined?"[object Undefined]":"[object Null]"}return p.call(e)}function d(e){return e===true||e===false||e!==null&&typeof e==="object"&&g(e)==="[object Boolean]"}function b(e){return typeof e==="number"||e!==null&&typeof e==="object"&&g(e)==="[object Number]"}function y(e){var t=typeof e;return t==="string"||t==="object"&&e!=null&&!Array.isArray(e)&&g(e)==="[object String]"}function m(e){var t=typeof e;return t==="symbol"||t==="object"&&e!==null&&g(e)==="[object Symbol]"}function w(e){if(!u(e)){return false}var t=g(e);return t==="[object Function]"||t==="[object AsyncFunction]"||t==="[object GeneratorFunction]"||t==="[object Proxy]"}function x(e){if(e===null||typeof e!=="object"||g(e)!="[object Object]"){return false}if(Object.getPrototypeOf(e)===null){return true}var t=e;while(Object.getPrototypeOf(t)!==null){t=Object.getPrototypeOf(t)}return Object.getPrototypeOf(e)===t}function j(e){if(e===null||typeof e!=="object"){return false}var t=g(e);return t==="[object Error]"||t==="[object DOMException]"||typeof e.message==="string"&&typeof e.name==="string"&&!x(e)}function O(e){var t=[u(e)?"Object":"Basic","*"];if(e===undefined)t[1]="Undefined";else if(e===null)t[1]="Null";else if(d(e))t[1]="Boolean";else if(b(e))t[1]="Number";else if(y(e))t[1]="String";else if(m(e))t[1]="Symbol";else if(w(e))t[1]="Function";else if(Array.isArray(e))t[1]="Array";else if(j(e))t[1]="Error";else if(x(e))t[1]="Plain";else{if(typeof e==="object"){if(e.nodeType===3)t[1]="Text";else if(e.nodeType===1||e.nodeType===9||e.nodeType===11)t[1]="Element";else if(e.nodeType===2)t[1]="Attribute";else if(e.nodeType===8)t[1]="Comment"}}return t}var E=function(e,t){return t!==null&&typeof t==="object"&&e.indexOf(t.nodeType)>-1&&!x(t)};var k=u;var T=function(e){return e===undefined};var F=function(e){return e===null};var N=d;var A=b;var M=y;var S=m;var P=w;var q=function(e){return Array.isArray(e)};var C=j;var I=x;var V=function(e){return E([1,9,11],e)};var _=function(e){return E([2],e)};var B=function(e){return E([3],e)};var D=function(e){return E([8],e)};function K(e,t,n){if(e<t){var r=t;t=e;e=r}else if(e==t){return[e]}var o=(e+".").split(".")[1].length;var i=(t+".").split(".")[1].length;var l=o>i?o:i;var a=function(e){var t=e<100&&e>-100?10:.1;var n=1,r=e;while(t==10?r>=-100&&r<=100:r<=-100||r>=100){n*=t;r*=t}return n}(e-t);var u=+(Math.ceil((e-t)*a/n)/a).toFixed(l);if(u<=0)return[t,e];var f=Math.floor(t/u)*u;var c=[],s;c.push(f);for(s=1;c[c.length-1]<e;s++){c.push(+(f+u*s).toFixed(l))}c[0]=+f.toFixed(l);var h=[c[0]];for(var v=1;v<c.length;v++){if(h[h.length-1]!=c[v]){h.push(c[v])}}return h}function U(t){var n={index:-1,currentChar:null};n.readNext=function(){n.currentChar=n.index++<t.length-1?t[n.index]:null;return n.currentChar};n.getNextN=function(e){return t.substring(n.index,e+n.index>t.length?t.length:e+n.index)};return n}var z=U;function G(t,e){var n=[];var r=0;var o=function(e){return t.substring(r,e+r>t.length?t.length:e+r)};var i="";var l="tag";var a=function(){if(i!=""){n.push({color:{tag:e.selector,attr:e.attrKey,string:e.attrValue}[l],content:i})}i=""};while(true){if(o(2)=="/*"){a();while(o(2)!=="*/"&&r<t.length){i+=t[r++]}n.push({color:e.annotation,content:i+o(2)});r+=2;i=""}else if(["'",'"'].indexOf(o(1))>-1){var u=o(1);a();do{i+=t[r++]}while(o(1)!=u&&r<t.length);if(o(1)!=u){u=""}else{r+=1}n.push({color:e.attrValue,content:i+u});i=""}else if([":","{","}",";"].indexOf(o(1))>-1){a();n.push({color:e.insign,content:o(1)});i="";if(o(1)=="{"||o(1)==";"){l="attr"}else if(o(1)=="}"){l="tag"}else{l="string"}r+=1}else{if(r>=t.length){a();break}else{i+=t[r++]}}}return n}var H=["abstract","arguments","boolean","break","byte","case","catch","char","class","const","continue","debugger","default","delete","do","double","else","enum","eval","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","let","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","var","void","volatile","while","with","yield"];function L(t,e){var n=[];var r=0;var o=function(e){return t.substring(r,e+r>t.length?t.length:e+r)};var i="";var l=function(){if(i!=""){if(i[0]=="("){n.push({color:e.insign,content:"("});i=i.substr(1)}n.push({color:e.text,content:i})}i=""};while(true){if(o(2)=="/*"){l();while(o(2)!=="*/"&&r<t.length){i+=t[r++]}n.push({color:e.annotation,content:i+o(2)});r+=2;i=""}else if(o(2)=="//"){l();while(o(1)!=="\n"&&r<t.length){i+=t[r++]}n.push({color:e.annotation,content:i});i=""}else if(["'",'"',"`"].indexOf(o(1))>-1){var a=o(1);l();do{i+=t[r++]}while(o(1)!=a&&r<t.length);if(o(1)!=a){a=""}else{r+=1}n.push({color:e.string,content:i+a});i=""}else if(o(1)=="("&&(i[0]==" "||r-i.length-1>=0&&t[r-i.length-1]==" ")){n.push({color:e.funName,content:i});r+=1;i="("}else if(o(1)=="("){n.push({color:e.execName,content:i});r+=1;i="("}else if([";","{","}","(",")",".","\n","=","+",">","<","[","]","-","*","/","^","*","!"].indexOf(o(1))>-1){l();n.push({color:e.insign,content:o(1)});i="";r+=1}else if(o(1)==" "&&H.indexOf(i.trim())>-1){n.push({color:e.key,content:i+" "});i="";r+=1}else{if(r>=t.length){l();break}else{i+=t[r++]}}}return n}function R(t,n){var r=[];var o=0;var i=function(e){return t.substring(o,e+o>t.length?t.length:e+o)};var l="";var e=function(){if(l!=""){r.push({color:n.text,content:l})}l=""};var a=function(){var e=" ";if(i(1)=='"')e='"';if(i(1)=="'")e="'";do{l+=t[o++]}while(i(1)!=e&&o<t.length);if(e!=" "&&o<t.length){l+=e;o+=1}r.push({color:n.attrValue,content:l});l=""};while(true){if(i(4)=="\x3c!--"){e();while(i(3)!=="--\x3e"&&o<t.length){l+=t[o++]}r.push({color:n.annotation,content:l+i(3)});o+=3;l=""}else if(i(2)=="</"){e();r.push({color:n.insign,content:"</"});o+=2;while(i(1)!==">"&&o<t.length){l+=t[o++]}if(l!=""){r.push({color:n.node,content:l});l="";if(o<t.length){r.push({color:n.insign,content:">"});o+=1}}}else if(i(1)=="<"&&i(2)!="< "){var u="";e();r.push({color:n.insign,content:"<"});o+=1;while(i(1)!=">"&&i(1)!=" "&&o<t.length){l+=t[o++]}if(l!=""){if(l=="style"||l=="script"){u="</"+l+">"}r.push({color:n.node,content:l});l="";if(o<t.length){while(o<t.length){if(i(1)==">"){e();r.push({color:n.insign,content:">"});o+=1;break}else if(i(1)!=" "){e();if(i(1)!='"'&&i(1)!="'"){while(i(1)!="="&&i(1)!=">"&&o<t.length&&i(1)!=" "){l+=t[o++]}if(l!=""){r.push({color:n.attrKey,content:l});l="";if(i(1)=="="){r.push({color:n.insign,content:"="});o+=1;if(o<t.length&&i(1)!=" "&&i(1)!=">"){a()}}}else{l+=t[o++]}}else if(i(1)=="="){r.push({color:n.insign,content:"="});o+=1}else{if(o<t.length&&i(1)!=" "&&i(1)!=">"){a()}}}else{l+=t[o++]}}}}if(u!=""){var f=o,c=l,s,h;while(i(u.length)!=u&&o<t.length){l+=t[o++]}if(o<t.length){s=u.replace(/<\//,"");h={"style>":G,"script>":L}[s](l,{"style>":n._css,"script>":n._javascript}[s]);h.forEach(function(e){r.push(e)});l=""}else{l=c;o=f}}}else{if(o>=t.length){e();break}else{l+=t[o++]}}}return r}var Y=function(e){var r=[[]],o=0;e.forEach(function(e){var t=e.content.split(/\n/),n;r[o].push({color:e.color,content:t[0]});for(n=1;n<t.length;n++){o+=1;r.push([]);r[o].push({color:e.color,content:t[n]})}});return r};var J=function(e,t){var n;for(n in t)try{e[n]=t[n]}catch(e){throw new Error("Illegal property value！")}return e};var Q={text:"#000000",annotation:"#6a9955",insign:"#ffffff",node:"#1e50b3",attrKey:"#1e83b1",attrValue:"#ac4c1e"};var W={annotation:"#6a9955",insign:"#ffffff",selector:"#1e50b3",attrKey:"#1e83b1",attrValue:"#ac4c1e"};var X={text:"#000000",annotation:"#6a9955",insign:"#ffffff",key:"#ff0000",string:"#ac4c1e",funName:"#1e50b3",execName:"#1e83b1"};function Z(e,t){t=t||{};var n,r;if(e=="html"){t._css=J(W,t.css);t._javascript=J(X,t.javascript);r=J(Q,t);n=R}else if(e=="css"){r=J(W,t);n=G}else if(e=="javascript"){r=J(X,t);n=L}else{throw new Error("Language not supported:"+e+",The languages available include: html、css、javascript!")}return function(e){return Y(n(e,r))}}var $={animation:e,Matrix4:t,Hermite:r,getType:O,isUndefined:T,isNull:F,isBoolean:N,isNumber:A,isString:M,isSymbol:S,isFunction:P,isArray:q,isError:C,isPlainObject:I,isObject:k,isElement:V,isAttribute:_,isText:B,isComment:D,ruler:K,ReadString:z,Shader:Z};if(typeof module==="object"&&typeof module.exports==="object"){module.exports=$}else{window.tool=$}})();
/*!
 * 💡 tool.js - 💡 前端常用的工具类方法汇总。
 * git+https://github.com/hai2007/tool.js.git
 *
 * author 你好2007 < https://hai2007.gitee.io/sweethome >
 *
 * version 0.8.0
 *
 * Copyright (c) 2020-present hai2007 走一步，再走一步。
 * Released under the MIT license
 *
 * Date:Tue Jun 29 2021 10:09:29 GMT+0800 (中国标准时间)
 */
(function(){"use strict";var l=[];var i=13;var o=400;var u=null;function e(t,e,r){if(arguments.length<2)e=o;var a={timer:function(e,t,r){if(!e){throw new Error("Tick is required!")}var n=(new Date).valueOf()+"_"+(Math.random()*1e3).toFixed(0);l.push({id:n,createTime:new Date,tick:e,duration:t,callback:r});a.start();return n},start:function(){if(!u){u=setInterval(a.tick,i)}},tick:function(){var e,t,r,n,i,o,u,f=l;l=[];l.length=0;for(t=0;t<f.length;t++){i=f[t];e=i.createTime;r=i.tick;o=i.duration;n=i.callback;u=(+new Date-e)/o;u=u>1?1:u;r(u);if(u<1&&i.id){l.push(i)}else if(n){n(u)}}if(l.length<=0){a.stop()}},stop:function(){if(u){clearInterval(u);u=null}}};var n=a.timer(function(e){t(e)},e,r);return function(){var e;for(e in l){if(l[e].id==n){l[e].id=undefined;return}}}}function f(e,t,r,n){n=n||0;var i=Math.sqrt(t*t+r*r+n*n);return[1,0,0,0,0,1,0,0,0,0,1,0,t*e/i,r*e/i,n*e/i,1]}function c(e){var t=Math.sin(e),r=Math.cos(e);return[r,t,0,0,-t,r,0,0,0,0,1,0,0,0,0,1]}function s(e,t,r,n,i,o){n=n||0;i=i||0;o=o||0;return[e,0,0,0,0,t,0,0,0,0,r,0,n-n*e,i-i*t,o-o*r,1]}function d(e,t,r,n,i,o){if(typeof e==="number"&&typeof t==="number"){if(typeof r!=="number"){r=0;n=e;i=t;o=1}else if(typeof n!=="number"||typeof i!=="number"||typeof o!=="number"){n=e;i=t;o=r;e=0;t=0;r=0}if(e==n&&t==i&&r==o)throw new Error("It's not a legitimate ray!");var u=Math.sqrt((n-e)*(n-e)+(i-t)*(i-t)),f=u!=0?(i-t)/u:1,a=u!=0?(n-e)/u:0,l=(n-e)*a+(i-t)*f,c=o-r,s=Math.sqrt(l*l+c*c),d=s!=0?c/s:1,v=s!=0?l/s:0;return[[f,d*a,a*v,0,-a,f*d,f*v,0,0,-v,d,0,t*a-e*f,r*v-e*a*d-t*f*d,-e*a*v-t*f*v-r*d,1],[f,-a,0,0,d*a,d*f,-v,0,a*v,f*v,d,0,e,t,r,1]]}else{throw new Error("a1 and b1 is required!")}}var v=function(e,t){var r=[];for(var n=0;n<4;n++)for(var i=0;i<t.length/4;i++)r[i*4+n]=e[n]*t[i*4]+e[n+4]*t[i*4+1]+e[n+8]*t[i*4+2]+e[n+12]*t[i*4+3];return r};function t(e){var a=e||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var l={move:function(e,t,r,n){a=v(f(e,t,r,n),a);return l},rotate:function(e,t,r,n,i,o,u){var f=d(t,r,n,i,o,u);a=v(v(v(f[1],c(e)),f[0]),a);return l},scale:function(e,t,r,n,i,o){a=v(s(e,t,r,n,i,o),a);return l},multiply:function(e,t){a=t?v(a,e):v(e,a);return l},use:function(e,t,r,n){r=r||0;n=n||1;var i=v(a,[e,t,r,n]);i[0]=+i[0].toFixed(7);i[1]=+i[1].toFixed(7);i[2]=+i[2].toFixed(7);i[3]=+i[3].toFixed(7);return i},value:function(){return a}};return l}function r(e,t){for(var r in t)try{e[r]=t[r]}catch(e){throw new Error("Illegal property value！")}return e}function n(a){a=r({u:.5},a);var l,c,s;var d=function(e){if(l){var t=(e-c)/(s-c),r=t*t,n=t*r;var i=n*l[0]+r*l[1]+t*l[2]+l[3];return i*(s-c)}else throw new Error("You shoud first set the position!")};d.setP=function(e,t,r,n,i,o){if(e<r){c=e;s=r;var u=a.u*i,f=a.u*o;t/=r-e;n/=r-e;l=[2*t-2*n+u+f,3*n-3*t-2*u-f,u,t]}else throw new Error("The point x-position should be increamented!");return d};return d}function a(e){var t=typeof e;return e!=null&&(t==="object"||t==="function")}var p=Object.prototype.toString;function h(e){if(e==null){return e===undefined?"[object Undefined]":"[object Null]"}return p.call(e)}function y(e){return e===true||e===false||e!==null&&typeof e==="object"&&h(e)==="[object Boolean]"}function g(e){return typeof e==="number"||e!==null&&typeof e==="object"&&h(e)==="[object Number]"}function b(e){var t=typeof e;return t==="string"||t==="object"&&e!=null&&!Array.isArray(e)&&h(e)==="[object String]"}function m(e){var t=typeof e;return t==="symbol"||t==="object"&&e!==null&&h(e)==="[object Symbol]"}function w(e){if(!a(e)){return false}var t=h(e);return t==="[object Function]"||t==="[object AsyncFunction]"||t==="[object GeneratorFunction]"||t==="[object Proxy]"}function x(e){if(e===null||typeof e!=="object"||h(e)!="[object Object]"){return false}if(Object.getPrototypeOf(e)===null){return true}var t=e;while(Object.getPrototypeOf(t)!==null){t=Object.getPrototypeOf(t)}return Object.getPrototypeOf(e)===t}function j(e){if(e===null||typeof e!=="object"){return false}var t=h(e);return t==="[object Error]"||t==="[object DOMException]"||typeof e.message==="string"&&typeof e.name==="string"&&!x(e)}function N(e){var t=[a(e)?"Object":"Basic","*"];if(e===undefined)t[1]="Undefined";else if(e===null)t[1]="Null";else if(y(e))t[1]="Boolean";else if(g(e))t[1]="Number";else if(b(e))t[1]="String";else if(m(e))t[1]="Symbol";else if(w(e))t[1]="Function";else if(Array.isArray(e))t[1]="Array";else if(j(e))t[1]="Error";else if(x(e))t[1]="Plain";else{if(typeof e==="object"){if(e.nodeType===3)t[1]="Text";else if(e.nodeType===1||e.nodeType===9||e.nodeType===11)t[1]="Element";else if(e.nodeType===2)t[1]="Attribute";else if(e.nodeType===8)t[1]="Comment"}}return t}var E=function(e,t){return t!==null&&typeof t==="object"&&e.indexOf(t.nodeType)>-1&&!x(t)};var T=function(e){return e===undefined};var A=function(e){return e===null};var S=y;var O=g;var C=b;var P=m;var k=w;var M=function(e){return Array.isArray(e)};var L=j;var B=x;var F=function(e){return E([1,9,11],e)};var H=function(e){return E([2],e)};var D=function(e){return E([3],e)};var q=function(e){return E([8],e)};var K={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};var V={stopPropagation:function(e){e=e||window.event;if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}},preventDefault:function(e){e=e||window.event;if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},isNode:function(e){return e&&(e.nodeType===1||e.nodeType===9||e.nodeType===11)},bind:function(e,t,r){if(e.constructor===Array||e.constructor===NodeList||e.constructor===HTMLCollection){for(var n=0;n<e.length;n++){this.bind(e[n],t,r)}return}if(window.attachEvent)e.attachEvent("on"+t,r);else e.addEventListener(t,r,false)},unbind:function(e,t,r){if(e.constructor===Array||e.constructor===NodeList||e.constructor===HTMLCollection){for(var n=0;n<e.length;n++){this.unbind(e[n],t,r)}return}if(window.detachEvent)e.detachEvent("on"+t,r);else e.removeEventListener(t,r,false)},find:function(e,t,r){if(!this.isNode(e))return[];var n=e.getElementsByTagName(r||"*");var i=[];for(var o=0;o<n.length;o++){if(this.isNode(n[o])&&(typeof t!="function"||t(n[o])))i.push(n[o])}return i},children:function(e,t){var r=e.childNodes;var n=[];for(var i=0;i<r.length;i++){if(this.isNode(r[i])&&(typeof t!="function"||t(r[i])))n.push(r[i])}return n},hasClass:function(e,t,r){if(t.constructor!==Array)t=[t];var n=" "+(e.getAttribute("class")||"")+" ";for(var i=0;i<t.length;i++){if(n.indexOf(" "+t[i]+" ")>=0){if(r)return true}else{if(!r)return false}}return true},removeClass:function(e,t){var r=" "+(e.getAttribute("class")||"")+" ";var n=r.replace(" "+t.trim()+" "," ");e.setAttribute("class",n.trim())},addClass:function(e,t){if(this.hasClass(e,t))return;var r=e.getAttribute("class")||"";e.setAttribute("class",r+" "+t)},toNode:function(e,t){var r;if(t)r=document.createElementNS(K.svg,"svg");else{var n="div";if(/^<tr[> ]/.test(e)){n="tbody"}else if(/^<th[> ]/.test(e)||/^<td[> ]/.test(e)){n="tr"}else if(/^<thead[> ]/.test(e)||/^<tbody[> ]/.test(e)){n="table"}r=document.createElement(n)}r.innerHTML=e;var i=r.childNodes;for(var o=0;o<i.length;o++){if(this.isNode(i[o]))return i[o]}},trigger:function(e,t){if(document.createEventObject){e.fireEvent("on"+t,document.createEventObject())}else{var r=document.createEvent("HTMLEvents");r.initEvent(t,true,false);e.dispatchEvent(r)}},getStyle:function(e,t){var r=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null):e.currentStyle;return typeof t==="string"?r.getPropertyValue(t):r},offsetPosition:function(e){var t=0;var r=0;r=e.offsetTop;t=e.offsetLeft;e=e.offsetParent;while(e){r+=e.offsetTop;t+=e.offsetLeft;e=e.offsetParent}return{left:t,top:r}},mousePosition:function(e,t){var r=e.getBoundingClientRect();if(!t||!t.clientX)throw new Error("Event is necessary!");return{x:t.clientX-r.left,y:t.clientY-r.top}},remove:function(e){e.parentNode.removeChild(e)},setStyles:function(e,t){for(var r in t)e.style[r]=t[r]},size:function(e,t){var r,n;if(t=="content"){n=e.clientWidth-(this.getStyle(e,"padding-left")+"").replace("px","")-(this.getStyle(e,"padding-right")+"").replace("px","");r=e.clientHeight-(this.getStyle(e,"padding-top")+"").replace("px","")-(this.getStyle(e,"padding-bottom")+"").replace("px","")}else if(t=="padding"){n=e.clientWidth;r=e.clientHeight}else if(t=="border"){n=e.offsetWidth;r=e.offsetHeight}else if(t=="scroll"){n=e.scrollWidth;r=e.scrollHeight}else{n=e.offsetWidth;r=e.offsetHeight}return{width:n,height:r}},append:function(e,t){var r=this.isNode(t)?t:this.toNode(t);e.appendChild(r);return r},prepend:function(e,t){var r=this.isNode(t)?t:this.toNode(t);e.insertBefore(r,e.childNodes[0]);return r},after:function(e,t){var r=this.isNode(t)?t:this.toNode(t);e.parentNode.insertBefore(r,e.nextSibling);return r},before:function(e,t){var r=this.isNode(t)?t:this.toNode(t);e.parentNode.insertBefore(r,e);return r}};var W={48:[0,")"],49:[1,"!"],50:[2,"@"],51:[3,"#"],52:[4,"$"],53:[5,"%"],54:[6,"^"],55:[7,"&"],56:[8,"*"],57:[9,"("],96:[0,0],97:1,98:2,99:3,100:4,101:5,102:6,103:7,104:8,105:9,106:"*",107:"+",109:"-",110:".",111:"/",65:["a","A"],66:["b","B"],67:["c","C"],68:["d","D"],69:["e","E"],70:["f","F"],71:["g","G"],72:["h","H"],73:["i","I"],74:["j","J"],75:["k","K"],76:["l","L"],77:["m","M"],78:["n","N"],79:["o","O"],80:["p","P"],81:["q","Q"],82:["r","R"],83:["s","S"],84:["t","T"],85:["u","U"],86:["v","V"],87:["w","W"],88:["x","X"],89:["y","Y"],90:["z","Z"],37:"left",38:"up",39:"right",40:"down",33:"page up",34:"page down",35:"end",36:"home",16:"shift",17:"ctrl",18:"alt",91:"command",92:"command",93:"command",9:"tab",20:"caps lock",32:"spacebar",8:"backspace",13:"enter",27:"esc",46:"delete",45:"insert",144:"number lock",145:"scroll lock",12:"clear",19:"pause",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",189:["-","_"],187:["=","+"],219:["[","{"],221:["]","}"],220:["\\","|"],186:[";",":"],222:["'",'"'],188:[",","<"],190:[".",">"],191:["/","?"],192:["`","~"]};var I=["shift","ctrl","alt"];function U(e){e=e||window.event;var t=e.keyCode||e.which;var r=W[t]||t;if(!r)return;if(r.constructor!==Array)r=[r,r];var n=r[0];var i=e.shiftKey?"shift+":"",o=e.altKey?"alt+":"",u=e.ctrlKey?"ctrl+":"";var f="",a=u+i+o;if(I.indexOf(r[0])>=0){r[0]=r[1]=""}var l=e.code=="Key"+e.key&&!i;f=a+(a==""&&l?r[1]:r[0]);if(r[0]==""){f=f.replace(/\+$/,"")}return f==""?n:f}function X(e,t,r){if(e<t){var n=t;t=e;e=n}else if(e==t){return[e]}var i=function(e){var t=e<100&&e>-100?10:.1;var r=1,n=e;while(t==10?n>=-100&&n<=100:n<=-100||n>=100){r*=t;n*=t}return r}(e-t);var o=Math.ceil((e-t)*i/r)/i;var u=Math.floor(t/o)*o;var f=[],a;f.push(u);for(a=1;f[f.length-1]<e;a++){f.push(u+o*a)}return f}function R(t){var r={index:-1,currentChar:null};r.readNext=function(){r.currentChar=r.index++<t.length-1?t[r.index]:null;return r.currentChar};r.getNextN=function(e){return t.substring(r.index,e+r.index>t.length?t.length:e+r.index)};return r}var Y=R;var z={animation:e,Matrix4:t,Hermite:n,getType:N,isUndefined:T,isNull:A,isBoolean:S,isNumber:O,isString:C,isSymbol:P,isFunction:k,isArray:M,isError:L,isPlainObject:B,isElement:F,isAttribute:H,isText:D,isComment:q,xhtml:V,getKeyString:U,ruler:X,ReadString:Y};if(typeof module==="object"&&typeof module.exports==="object"){module.exports=z}else{window.tool=z}})();
/*!
 * 💡 tool.js - 💡 前端常用的工具类方法汇总。
 * git+https://github.com/hai2007/tool.js.git
 *
 * author 你好2007 < https://hai2007.gitee.io/sweethome >
 *
 * version 0.9.0
 *
 * Copyright (c) 2020-present hai2007 走一步，再走一步。
 * Released under the MIT license
 *
 * Date:Tue Jul 20 2021 12:56:23 GMT+0800 (中国标准时间)
 */
(function(){"use strict";var s=[];var i=13;var o=400;var a=null;function e(t,e,n){if(arguments.length<2)e=o;var f={timer:function(e,t,n){if(!e){throw new Error("Tick is required!")}var r=(new Date).valueOf()+"_"+(Math.random()*1e3).toFixed(0);s.push({id:r,createTime:new Date,tick:e,duration:t,callback:n});f.start();return r},start:function(){if(!a){a=setInterval(f.tick,i)}},tick:function(){var e,t,n,r,i,o,a,l=s;s=[];s.length=0;for(t=0;t<l.length;t++){i=l[t];e=i.createTime;n=i.tick;o=i.duration;r=i.callback;a=(+new Date-e)/o;a=a>1?1:a;n(a);if(a<1&&i.id){s.push(i)}else if(r){r(a)}}if(s.length<=0){f.stop()}},stop:function(){if(a){clearInterval(a);a=null}}};var r=f.timer(function(e){t(e)},e,n);return function(){var e;for(e in s){if(s[e].id==r){s[e].id=undefined;return}}}}function l(e,t,n,r){r=r||0;var i=Math.sqrt(t*t+n*n+r*r);return[1,0,0,0,0,1,0,0,0,0,1,0,t*e/i,n*e/i,r*e/i,1]}function u(e){var t=Math.sin(e),n=Math.cos(e);return[n,t,0,0,-t,n,0,0,0,0,1,0,0,0,0,1]}function c(e,t,n,r,i,o){r=r||0;i=i||0;o=o||0;return[e,0,0,0,0,t,0,0,0,0,n,0,r-r*e,i-i*t,o-o*n,1]}function h(e,t,n,r,i,o){if(typeof e==="number"&&typeof t==="number"){if(typeof n!=="number"){n=0;r=e;i=t;o=1}else if(typeof r!=="number"||typeof i!=="number"||typeof o!=="number"){r=e;i=t;o=n;e=0;t=0;n=0}if(e==r&&t==i&&n==o)throw new Error("It's not a legitimate ray!");var a=Math.sqrt((r-e)*(r-e)+(i-t)*(i-t)),l=a!=0?(i-t)/a:1,f=a!=0?(r-e)/a:0,s=(r-e)*f+(i-t)*l,u=o-n,c=Math.sqrt(s*s+u*u),h=c!=0?u/c:1,v=c!=0?s/c:0;return[[l,h*f,f*v,0,-f,l*h,l*v,0,0,-v,h,0,t*f-e*l,n*v-e*f*h-t*l*h,-e*f*v-t*l*v-n*h,1],[l,-f,0,0,h*f,h*l,-v,0,f*v,l*v,h,0,e,t,n,1]]}else{throw new Error("a1 and b1 is required!")}}var v=function(e,t){var n=[];for(var r=0;r<4;r++)for(var i=0;i<t.length/4;i++)n[i*4+r]=e[r]*t[i*4]+e[r+4]*t[i*4+1]+e[r+8]*t[i*4+2]+e[r+12]*t[i*4+3];return n};function t(e){var f=e||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var s={move:function(e,t,n,r){f=v(l(e,t,n,r),f);return s},rotate:function(e,t,n,r,i,o,a){var l=h(t,n,r,i,o,a);f=v(v(v(l[1],u(e)),l[0]),f);return s},scale:function(e,t,n,r,i,o){f=v(c(e,t,n,r,i,o),f);return s},multiply:function(e,t){f=t?v(f,e):v(e,f);return s},use:function(e,t,n,r){n=n||0;r=r||1;var i=v(f,[e,t,n,r]);i[0]=+i[0].toFixed(7);i[1]=+i[1].toFixed(7);i[2]=+i[2].toFixed(7);i[3]=+i[3].toFixed(7);return i},value:function(){return f}};return s}function n(e,t){for(var n in t)try{e[n]=t[n]}catch(e){throw new Error("Illegal property value！")}return e}function r(f){f=n({u:.5},f);var s,u,c;var h=function(e){if(s){var t=(e-u)/(c-u),n=t*t,r=t*n;var i=r*s[0]+n*s[1]+t*s[2]+s[3];return i*(c-u)}else throw new Error("You shoud first set the position!")};h.setP=function(e,t,n,r,i,o){if(e<n){u=e;c=n;var a=f.u*i,l=f.u*o;t/=n-e;r/=n-e;s=[2*t-2*r+a+l,3*r-3*t-2*a-l,a,t]}else throw new Error("The point x-position should be increamented!");return h};return h}function f(e){var t=typeof e;return e!=null&&(t==="object"||t==="function")}var d=Object.prototype.toString;function p(e){if(e==null){return e===undefined?"[object Undefined]":"[object Null]"}return d.call(e)}function g(e){return e===true||e===false||e!==null&&typeof e==="object"&&p(e)==="[object Boolean]"}function y(e){return typeof e==="number"||e!==null&&typeof e==="object"&&p(e)==="[object Number]"}function b(e){var t=typeof e;return t==="string"||t==="object"&&e!=null&&!Array.isArray(e)&&p(e)==="[object String]"}function m(e){var t=typeof e;return t==="symbol"||t==="object"&&e!==null&&p(e)==="[object Symbol]"}function w(e){if(!f(e)){return false}var t=p(e);return t==="[object Function]"||t==="[object AsyncFunction]"||t==="[object GeneratorFunction]"||t==="[object Proxy]"}function x(e){if(e===null||typeof e!=="object"||p(e)!="[object Object]"){return false}if(Object.getPrototypeOf(e)===null){return true}var t=e;while(Object.getPrototypeOf(t)!==null){t=Object.getPrototypeOf(t)}return Object.getPrototypeOf(e)===t}function j(e){if(e===null||typeof e!=="object"){return false}var t=p(e);return t==="[object Error]"||t==="[object DOMException]"||typeof e.message==="string"&&typeof e.name==="string"&&!x(e)}function N(e){var t=[f(e)?"Object":"Basic","*"];if(e===undefined)t[1]="Undefined";else if(e===null)t[1]="Null";else if(g(e))t[1]="Boolean";else if(y(e))t[1]="Number";else if(b(e))t[1]="String";else if(m(e))t[1]="Symbol";else if(w(e))t[1]="Function";else if(Array.isArray(e))t[1]="Array";else if(j(e))t[1]="Error";else if(x(e))t[1]="Plain";else{if(typeof e==="object"){if(e.nodeType===3)t[1]="Text";else if(e.nodeType===1||e.nodeType===9||e.nodeType===11)t[1]="Element";else if(e.nodeType===2)t[1]="Attribute";else if(e.nodeType===8)t[1]="Comment"}}return t}var E=function(e,t){return t!==null&&typeof t==="object"&&e.indexOf(t.nodeType)>-1&&!x(t)};var T=function(e){return e===undefined};var O=function(e){return e===null};var k=g;var S=y;var A=b;var C=m;var P=w;var M=function(e){return Array.isArray(e)};var F=j;var L=x;var B=function(e){return E([1,9,11],e)};var H=function(e){return E([2],e)};var V=function(e){return E([3],e)};var K=function(e){return E([8],e)};var D={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};var q={stopPropagation:function(e){e=e||window.event;if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}},preventDefault:function(e){e=e||window.event;if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},isNode:function(e){return e&&(e.nodeType===1||e.nodeType===9||e.nodeType===11)},bind:function(e,t,n){if(e.constructor===Array||e.constructor===NodeList||e.constructor===HTMLCollection){for(var r=0;r<e.length;r++){this.bind(e[r],t,n)}return}if(window.attachEvent)e.attachEvent("on"+t,n);else e.addEventListener(t,n,false)},unbind:function(e,t,n){if(e.constructor===Array||e.constructor===NodeList||e.constructor===HTMLCollection){for(var r=0;r<e.length;r++){this.unbind(e[r],t,n)}return}if(window.detachEvent)e.detachEvent("on"+t,n);else e.removeEventListener(t,n,false)},find:function(e,t,n){if(!this.isNode(e))return[];var r=e.getElementsByTagName(n||"*");var i=[];for(var o=0;o<r.length;o++){if(this.isNode(r[o])&&(typeof t!="function"||t(r[o])))i.push(r[o])}return i},children:function(e,t){var n=e.childNodes;var r=[];for(var i=0;i<n.length;i++){if(this.isNode(n[i])&&(typeof t!="function"||t(n[i])))r.push(n[i])}return r},hasClass:function(e,t,n){if(t.constructor!==Array)t=[t];var r=" "+(e.getAttribute("class")||"")+" ";for(var i=0;i<t.length;i++){if(r.indexOf(" "+t[i]+" ")>=0){if(n)return true}else{if(!n)return false}}return true},removeClass:function(e,t){var n=" "+(e.getAttribute("class")||"")+" ";var r=n.replace(" "+t.trim()+" "," ");e.setAttribute("class",r.trim())},addClass:function(e,t){if(this.hasClass(e,t))return;var n=e.getAttribute("class")||"";e.setAttribute("class",n+" "+t)},toNode:function(e,t){var n;if(t)n=document.createElementNS(D.svg,"svg");else{var r="div";if(/^<tr[> ]/.test(e)){r="tbody"}else if(/^<th[> ]/.test(e)||/^<td[> ]/.test(e)){r="tr"}else if(/^<thead[> ]/.test(e)||/^<tbody[> ]/.test(e)){r="table"}n=document.createElement(r)}n.innerHTML=e;var i=n.childNodes;for(var o=0;o<i.length;o++){if(this.isNode(i[o]))return i[o]}},trigger:function(e,t){if(document.createEventObject){e.fireEvent("on"+t,document.createEventObject())}else{var n=document.createEvent("HTMLEvents");n.initEvent(t,true,false);e.dispatchEvent(n)}},getStyle:function(e,t){var n=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null):e.currentStyle;return typeof t==="string"?n.getPropertyValue(t):n},offsetPosition:function(e){var t=0;var n=0;n=e.offsetTop;t=e.offsetLeft;e=e.offsetParent;while(e){n+=e.offsetTop;t+=e.offsetLeft;e=e.offsetParent}return{left:t,top:n}},mousePosition:function(e,t){var n=e.getBoundingClientRect();if(!t||!t.clientX)throw new Error("Event is necessary!");return{x:t.clientX-n.left,y:t.clientY-n.top}},remove:function(e){e.parentNode.removeChild(e)},setStyles:function(e,t){for(var n in t)e.style[n]=t[n]},size:function(e,t){var n,r;if(t=="content"){r=e.clientWidth-(this.getStyle(e,"padding-left")+"").replace("px","")-(this.getStyle(e,"padding-right")+"").replace("px","");n=e.clientHeight-(this.getStyle(e,"padding-top")+"").replace("px","")-(this.getStyle(e,"padding-bottom")+"").replace("px","")}else if(t=="padding"){r=e.clientWidth;n=e.clientHeight}else if(t=="border"){r=e.offsetWidth;n=e.offsetHeight}else if(t=="scroll"){r=e.scrollWidth;n=e.scrollHeight}else{r=e.offsetWidth;n=e.offsetHeight}return{width:r,height:n}},append:function(e,t){var n=this.isNode(t)?t:this.toNode(t);e.appendChild(n);return n},prepend:function(e,t){var n=this.isNode(t)?t:this.toNode(t);e.insertBefore(n,e.childNodes[0]);return n},after:function(e,t){var n=this.isNode(t)?t:this.toNode(t);e.parentNode.insertBefore(n,e.nextSibling);return n},before:function(e,t){var n=this.isNode(t)?t:this.toNode(t);e.parentNode.insertBefore(n,e);return n}};var I={48:[0,")"],49:[1,"!"],50:[2,"@"],51:[3,"#"],52:[4,"$"],53:[5,"%"],54:[6,"^"],55:[7,"&"],56:[8,"*"],57:[9,"("],96:[0,0],97:1,98:2,99:3,100:4,101:5,102:6,103:7,104:8,105:9,106:"*",107:"+",109:"-",110:".",111:"/",65:["a","A"],66:["b","B"],67:["c","C"],68:["d","D"],69:["e","E"],70:["f","F"],71:["g","G"],72:["h","H"],73:["i","I"],74:["j","J"],75:["k","K"],76:["l","L"],77:["m","M"],78:["n","N"],79:["o","O"],80:["p","P"],81:["q","Q"],82:["r","R"],83:["s","S"],84:["t","T"],85:["u","U"],86:["v","V"],87:["w","W"],88:["x","X"],89:["y","Y"],90:["z","Z"],37:"left",38:"up",39:"right",40:"down",33:"page up",34:"page down",35:"end",36:"home",16:"shift",17:"ctrl",18:"alt",91:"command",92:"command",93:"command",9:"tab",20:"caps lock",32:"spacebar",8:"backspace",13:"enter",27:"esc",46:"delete",45:"insert",144:"number lock",145:"scroll lock",12:"clear",19:"pause",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",189:["-","_"],187:["=","+"],219:["[","{"],221:["]","}"],220:["\\","|"],186:[";",":"],222:["'",'"'],188:[",","<"],190:[".",">"],191:["/","?"],192:["`","~"]};var W=["shift","ctrl","alt"];function _(e){e=e||window.event;var t=e.keyCode||e.which;var n=I[t]||t;if(!n)return;if(n.constructor!==Array)n=[n,n];var r=n[0];var i=e.shiftKey?"shift+":"",o=e.altKey?"alt+":"",a=e.ctrlKey?"ctrl+":"";var l="",f=a+i+o;if(W.indexOf(n[0])>=0){n[0]=n[1]=""}var s=e.code=="Key"+e.key&&!i;l=f+(f==""&&s?n[1]:n[0]);if(n[0]==""){l=l.replace(/\+$/,"")}return l==""?r:l}function U(e,t,n){if(e<t){var r=t;t=e;e=r}else if(e==t){return[e]}var i=(e+".").split(".")[1].length;var o=(t+".").split(".")[1].length;var a=i>o?i:o;var l=function(e){var t=e<100&&e>-100?10:.1;var n=1,r=e;while(t==10?r>=-100&&r<=100:r<=-100||r>=100){n*=t;r*=t}return n}(e-t);var f=Math.ceil((e-t)*l/n)/l;var s=Math.floor(t/f)*f;var u=[],c;u.push(s);for(c=1;u[u.length-1]<e;c++){u.push(+(s+f*c).toFixed(a))}u[0]=+s.toFixed(a);var h=[u[0]];for(var v=1;v<u.length;v++){if(h[h.length-1]!=u[v]){h.push(u[v])}}return h}function X(t){var n={index:-1,currentChar:null};n.readNext=function(){n.currentChar=n.index++<t.length-1?t[n.index]:null;return n.currentChar};n.getNextN=function(e){return t.substring(n.index,e+n.index>t.length?t.length:e+n.index)};return n}var z=X;function R(t,e){var n=[];var r=0;var i=function(e){return t.substring(r,e+r>t.length?t.length:e+r)};var o="";var a="tag";var l=function(){if(o!=""){n.push({color:{tag:e.selector,attr:e.attrKey,string:e.attrValue}[a],content:o})}o=""};while(true){if(i(2)=="/*"){l();while(i(2)!=="*/"&&r<t.length){o+=t[r++]}n.push({color:e.annotation,content:o+i(2)});r+=2;o=""}else if(["'",'"'].indexOf(i(1))>-1){var f=i(1);l();do{o+=t[r++]}while(i(1)!=f&&r<t.length);if(i(1)!=f){f=""}else{r+=1}n.push({color:e.attrValue,content:o+f});o=""}else if([":","{","}",";"].indexOf(i(1))>-1){l();n.push({color:e.insign,content:i(1)});o="";if(i(1)=="{"||i(1)==";"){a="attr"}else if(i(1)=="}"){a="tag"}else{a="string"}r+=1}else{if(r>=t.length){l();break}else{o+=t[r++]}}}return n}var Y=["abstract","arguments","boolean","break","byte","case","catch","char","class","const","continue","debugger","default","delete","do","double","else","enum","eval","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","let","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","var","void","volatile","while","with","yield"];function G(t,e){var n=[];var r=0;var i=function(e){return t.substring(r,e+r>t.length?t.length:e+r)};var o="";var a=function(){if(o!=""){if(o[0]=="("){n.push({color:e.insign,content:"("});o=o.substr(1)}n.push({color:e.text,content:o})}o=""};while(true){if(i(2)=="/*"){a();while(i(2)!=="*/"&&r<t.length){o+=t[r++]}n.push({color:e.annotation,content:o+i(2)});r+=2;o=""}else if(i(2)=="//"){a();while(i(1)!=="\n"&&r<t.length){o+=t[r++]}n.push({color:e.annotation,content:o});o=""}else if(["'",'"',"`"].indexOf(i(1))>-1){var l=i(1);a();do{o+=t[r++]}while(i(1)!=l&&r<t.length);if(i(1)!=l){l=""}else{r+=1}n.push({color:e.string,content:o+l});o=""}else if(i(1)=="("&&(o[0]==" "||r-o.length-1>=0&&t[r-o.length-1]==" ")){n.push({color:e.funName,content:o});r+=1;o="("}else if(i(1)=="("){n.push({color:e.execName,content:o});r+=1;o="("}else if([";","{","}","(",")",".","\n","=","+",">","<","[","]","-","*","/","^","*","!"].indexOf(i(1))>-1){a();n.push({color:e.insign,content:i(1)});o="";r+=1}else if(i(1)==" "&&Y.indexOf(o.trim())>-1){n.push({color:e.key,content:o+" "});o="";r+=1}else{if(r>=t.length){a();break}else{o+=t[r++]}}}return n}function $(t,n){var r=[];var i=0;var o=function(e){return t.substring(i,e+i>t.length?t.length:e+i)};var a="";var e=function(){if(a!=""){r.push({color:n.text,content:a})}a=""};var l=function(){var e=" ";if(o(1)=='"')e='"';if(o(1)=="'")e="'";do{a+=t[i++]}while(o(1)!=e&&i<t.length);if(e!=" "&&i<t.length){a+=e;i+=1}r.push({color:n.attrValue,content:a});a=""};while(true){if(o(4)=="\x3c!--"){e();while(o(3)!=="--\x3e"&&i<t.length){a+=t[i++]}r.push({color:n.annotation,content:a+o(3)});i+=3;a=""}else if(o(2)=="</"){e();r.push({color:n.insign,content:"</"});i+=2;while(o(1)!==">"&&i<t.length){a+=t[i++]}if(a!=""){r.push({color:n.node,content:a});a="";if(i<t.length){r.push({color:n.insign,content:">"});i+=1}}}else if(o(1)=="<"&&o(2)!="< "){var f="";e();r.push({color:n.insign,content:"<"});i+=1;while(o(1)!=">"&&o(1)!=" "&&i<t.length){a+=t[i++]}if(a!=""){if(a=="style"||a=="script"){f="</"+a+">"}r.push({color:n.node,content:a});a="";if(i<t.length){while(i<t.length){if(o(1)==">"){e();r.push({color:n.insign,content:">"});i+=1;break}else if(o(1)!=" "){e();if(o(1)!='"'&&o(1)!="'"){while(o(1)!="="&&o(1)!=">"&&i<t.length&&o(1)!=" "){a+=t[i++]}if(a!=""){r.push({color:n.attrKey,content:a});a="";if(o(1)=="="){r.push({color:n.insign,content:"="});i+=1;if(i<t.length&&o(1)!=" "&&o(1)!=">"){l()}}}else{a+=t[i++]}}else if(o(1)=="="){r.push({color:n.insign,content:"="});i+=1}else{if(i<t.length&&o(1)!=" "&&o(1)!=">"){l()}}}else{a+=t[i++]}}}}if(f!=""){var s=i,u=a,c,h;while(o(f.length)!=f&&i<t.length){a+=t[i++]}if(i<t.length){c=f.replace(/<\//,"");h={"style>":R,"script>":G}[c](a,{"style>":n._css,"script>":n._javascript}[c]);h.forEach(function(e){r.push(e)});a=""}else{a=u;i=s}}}else{if(i>=t.length){e();break}else{a+=t[i++]}}}return r}var J=function(e){var r=[[]],i=0;e.forEach(function(e){var t=e.content.split(/\n/),n;r[i].push({color:e.color,content:t[0]});for(n=1;n<t.length;n++){i+=1;r.push([]);r[i].push({color:e.color,content:t[n]})}});return r};var Q=function(e,t){var n;for(n in t)try{e[n]=t[n]}catch(e){throw new Error("Illegal property value！")}return e};var Z={text:"#000000",annotation:"#6a9955",insign:"#ffffff",node:"#1e50b3",attrKey:"#1e83b1",attrValue:"#ac4c1e"};var ee={annotation:"#6a9955",insign:"#ffffff",selector:"#1e50b3",attrKey:"#1e83b1",attrValue:"#ac4c1e"};var te={text:"#000000",annotation:"#6a9955",insign:"#ffffff",key:"#ff0000",string:"#ac4c1e",funName:"#1e50b3",execName:"#1e83b1"};function ne(e,t){t=t||{};var n,r;if(e=="html"){t._css=Q(ee,t.css);t._javascript=Q(te,t.javascript);r=Q(Z,t);n=$}else if(e=="css"){r=Q(ee,t);n=R}else if(e=="javascript"){r=Q(te,t);n=G}else{throw new Error("Language not supported:"+e+",The languages available include: html、css、javascript!")}return function(e){return J(n(e,r))}}var re={animation:e,Matrix4:t,Hermite:r,getType:N,isUndefined:T,isNull:O,isBoolean:k,isNumber:S,isString:A,isSymbol:C,isFunction:P,isArray:M,isError:F,isPlainObject:L,isElement:B,isAttribute:H,isText:V,isComment:K,xhtml:q,getKeyString:_,ruler:U,ReadString:z,Shader:ne};if(typeof module==="object"&&typeof module.exports==="object"){module.exports=re}else{window.tool=re}})();